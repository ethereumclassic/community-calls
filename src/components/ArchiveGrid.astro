---
import CallCard from "./CallCard.astro";
import { getCalls, sortCallsByDate } from "../lib/calls";

const allCalls = await getCalls();
const calls = sortCallsByDate(allCalls.filter((call) => !call.data.isUpcoming));
---

<section id="archive" class="scroll-mt-24">
  <div class="flex items-center justify-between mb-8">
    <h2 class="font-display text-3xl text-gray-100">
      <span class="text-etc-green/60">//</span> Archive
    </h2>
    <span class="text-xs font-mono text-gray-500 uppercase tracking-wider">
      {calls.length} past calls
    </span>
  </div>

  <div class="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
    {
      calls.map((call, index) => (
        <CallCard
          number={call.data.special ? undefined : call.data.callNumber}
          description={call.data.description}
          date={call.data.date}
          time={call.data.time}
          location={call.data.location}
          slug={call.data.slug!}
          youtube={call.data.youtube}
          index={index}
          special={call.data.special}
        />
      ))
    }
  </div>
</section>
