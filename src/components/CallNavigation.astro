---
import type { Call } from "../lib/types";
import { formatShortDate } from "../lib/dates";
import NavLink from "./NavLink.astro";

interface Props {
  prevCall?: Call | null;
  nextCall?: Call | null;
  currentCall?: Call | null;
  upcomingCall?: Call | null;
}

const { prevCall, nextCall, currentCall, upcomingCall } = Astro.props;

const prevNumber = prevCall?.data.callNumber;
const nextNumber = nextCall?.data.callNumber;
const prevSlug = prevCall?.data.slug;
const nextSlug = nextCall?.data.slug;
const prevDate = prevCall?.data.date
  ? formatShortDate(prevCall.data.date)
  : null;
const nextDate = nextCall?.data.date
  ? formatShortDate(nextCall.data.date)
  : null;
const prevDesc = prevCall?.data.description ?? "";
const nextDesc = nextCall?.data.description ?? "";

const prevTooltip = prevCall
  ? `Call ${prevNumber}${prevDate ? ` • ${prevDate}` : ""}${prevDesc ? `\n${prevDesc}` : ""}`
  : "";
const nextTooltip = nextCall
  ? `Call ${nextNumber}${nextDate ? ` • ${nextDate}` : ""}${nextDesc ? `\n${nextDesc}` : ""}`
  : "";

// Show upcoming link if there's an upcoming call and we're not on it
const showUpcomingLink =
  upcomingCall && currentCall && upcomingCall.id !== currentCall.id;
const upcomingSlug = upcomingCall?.data.slug;
---

<nav class="flex items-center justify-between mb-8">
  <NavLink href="/#archive" icon="lucide:chevron-left">Archive</NavLink>
  <div class="flex items-center gap-4">
    {
      prevSlug && (
        <NavLink
          href={`/calls/${prevSlug}`}
          icon="lucide:chevron-left"
          title={prevTooltip}
        >
          {prevNumber}
        </NavLink>
      )
    }
    {
      nextSlug && (
        <NavLink
          href={`/calls/${nextSlug}`}
          icon="lucide:chevron-right"
          iconPosition="right"
          title={nextTooltip}
        >
          {nextNumber}
        </NavLink>
      )
    }
    {
      showUpcomingLink && (
        <NavLink
          href={`/calls/${upcomingSlug}`}
          icon="lucide:chevrons-right"
          iconPosition="right"
          class="text-amber-600 hover:text-amber-400"
        >
          Upcoming
        </NavLink>
      )
    }
  </div>
</nav>
