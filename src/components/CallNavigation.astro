---
import type { Call } from "../lib/types";
import { Icon } from "astro-icon/components";
import { formatShortDate } from "../lib/dates";

interface Props {
  prevCall?: Call | null;
  nextCall?: Call | null;
}

const { prevCall, nextCall } = Astro.props;

const prevNumber = prevCall?.data.callNumber;
const nextNumber = nextCall?.data.callNumber;
const prevSlug = prevCall?.data.slug;
const nextSlug = nextCall?.data.slug;
const prevDate = prevCall?.data.date
  ? formatShortDate(prevCall.data.date)
  : null;
const nextDate = nextCall?.data.date
  ? formatShortDate(nextCall.data.date)
  : null;
const prevDesc = prevCall?.data.description ?? "";
const nextDesc = nextCall?.data.description ?? "";

const prevTooltip = prevCall
  ? `Call ${prevNumber}${prevDate ? ` • ${prevDate}` : ""}${prevDesc ? `\n${prevDesc}` : ""}`
  : "";
const nextTooltip = nextCall
  ? `Call ${nextNumber}${nextDate ? ` • ${nextDate}` : ""}${nextDesc ? `\n${nextDesc}` : ""}`
  : "";
---

<nav class="flex items-center justify-between mb-8">
  <a
    href="/#archive"
    data-astro-prefetch
    class="inline-flex items-center gap-2 text-xs font-mono uppercase tracking-wider text-gray-500 hover:text-etc-green transition-colors group"
  >
    <Icon
      name="lucide:chevron-left"
      class="icon-sm transform group-hover:-translate-x-1 transition-transform"
    />
    Archive
  </a>
  {
    (prevSlug || nextSlug) && (
      <div class="flex items-center gap-1 text-sm font-mono bg-surface-elevated/50 rounded-lg px-1 py-1 border border-etc-green/10">
        {prevSlug && (
          <a
            href={`/calls/${prevSlug}`}
            data-astro-prefetch
            class="px-3 py-1 text-gray-300 hover:text-etc-green hover:bg-etc-green/10 rounded transition-colors"
            title={prevTooltip}
          >
            &larr; {prevNumber}
          </a>
        )}
        {prevSlug && nextSlug && <span class="text-gray-600">|</span>}
        {nextSlug && (
          <a
            href={`/calls/${nextSlug}`}
            data-astro-prefetch
            class="px-3 py-1 text-gray-300 hover:text-etc-green hover:bg-etc-green/10 rounded transition-colors"
            title={nextTooltip}
          >
            {nextNumber} &rarr;
          </a>
        )}
      </div>
    )
  }
</nav>
